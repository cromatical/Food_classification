# 음식 데이터를 이용한 간단한 CNN
1. 데이터
2. 모델
3. 결과

## 1. 데이터
### 1) 기본 데이터
* food dataset : 5000 (50 클래스 * 100개)
	* train dataset : 4000 (80%)
	* validation dataset : 1000 (20%)
* 각 클래스당 포함되어 있는 이미지의 크기가 다르다.
* 음식마다 전체모습, 부분모습 등 다양한 이미지를 가지고 있다.

### 2) 추가 데이터
* 구글 이미지 페이지로부터 김밥, 떡볶이, 순대, 붕어빵, 호떡에 대하여 추가 이미지 수집
* 수집된 이미지에 대해 1차적으로 직접 음식이 아닌 데이터를 처리 하고 학습에 적절한 이미지가 사용되도록 너무 작은 이미지와 가로, 세로 길이 차이가 심한 이미지는 따로 처리
* 최종적으로 다음과 같이 기존 데이터셋과 데이터 균형이 맞도록 수집
	1. 떡볶이 : 115장
	2. 순대 : 95장
	3. 붕어빵 : 92장
	4. 호떡 : 101장
	5. 김밥 : 121장

### 3) Data augmentation
* 기존에 있는 데이터로만 학습을 진행할시 데이터 클래스당 너무 적은 데이터가 학습에 사용되고 Class 별 feature를 추출하는데 어려움이 있을거라 생각을 들고 과적합이 발생할 수 있기에 data augmentation도 진행
* 음식들의 이미지를 보았을 때 사진마다 일부 부분만 있는 음식, 전체가 있는 음식 등 다양한 방향 각도에 따라 사진이 있어서 아래와 같이 적용
	1. rotation
	2. width_shift
	3. height_shift
	4. zoom
	5. horizontal filp
	6. vertical flip

## 2. 모델
### 1) 학습 설정
* 실행환경 : 구글 코랩
* base_model : EfficientNetB0, EfficientNetB1
* optimizer : Adam
* learning_reate : 0.003
* Epochs / Batch_size : 15 / 32
* loss : sparse_categorical_crossentropy
* model_save : validation best loss

## 3. 결과
* 각 결과 마다 loss, acc의 약간의 차이가 있었으나 크게 다르지 않았으며 비슷하게 결과가 나왔다. data augmentation을 적용시킨 모델의 loss와 acc가 조금더 천천히 학습이 진행이 되었으며, 이는 augmenation을 적용시키지 않은 모델보다 더 많은 특징을 학습하기 때문에 보인다.
* augmentation을 적용전과 후를 보았을 때 augmentation을 적용 안시킨 모델의 성능이 3%정도 더 높게 나왔다. 아무래도 적절하지 않은 augmentation이 적용이 되어 오히려 학습에 영향을 끼치거나 epochs수가 부족하여 성능이 더 올라갈수 있는데 못올라가서 발생한거 같다.
* 재현율과 정밀도의 경우 서로 상호보완을 해주기에 값 차이가 크지 않아야 하는데 결과에서는 재현율보다 정밀도가 0.2~0.3정도 전부 높게 나왔으며 크게 차이는 없었다.
* 클래스를 새로 추가한 모델의 경우 어느정도 비슷한 특징들을 가진 음식 이미지를 추려서 추가를 해주었는데 매우 분류를 잘해내었다. 다른 특정케이스에 대해서 분류를 잘 해내지 못하였는데 실제 이미지를 보면 매우 유사하고 특징이 다양했기에 분류를 잘 해내지 못하였다.